\documentclass[12pt,fleqn]{article}
\usepackage{../../vkCourseML}
%\usepackage{vkCourseML}
\hypersetup{unicode=true}
%\usepackage[a4paper]{geometry}
\usepackage[hyphenbreaks]{breakurl}

\interfootnotelinepenalty=10000
\newcommand{\dx}[1]{\,\mathrm{d}#1} % маленький отступ и прямая d

\begin{document}
\title{Моделирование временных рядов\\Лекция 1\\Введение}
\author{Борис Демешев, Матвей Зехов}
\date{}
\maketitle

Временные ряды по сути своей лишь частный случай стандартной задачи регрессии или классификации. Они возникают в большом количестве областей. Например, любая компания из ретейла будет прогнозировать количество товаров, которые необходимо поставить в магазин или даркстор. Также обычно сразу приходит на ум котировки на фондовой бирже. Из физики и инженерных задач возникает анализ  сигналов от датчиков. Введём определение временного ряда. Перед этим мы должны ввести (очень нестрого) понятие случайного процесса.

\section{Определения}

Случайный процесс -- это некоторая \emph{последовательность} случайных величин $Y_t$. Мы специально сконцентрируемся только на дискретных последовательностях с вещественными значениями, так как для большинства задач этого достаточно. Следовательно, временным рядом мы будем называть некоторую \emph{реализацию} случайного процесса, $y_t$. Иногда эту реализацию ещё называют траекторией. Также можно встретить определение, что временной ряд это и есть случайный процесс (последовательность случайных велечин), но с практической точки зрения это немного не интуитивно и мы постараемся этого избегать.

На практике обычно мы имеем дело с последовательностями с конечным числом элементов $(y_t)_{t=1}^{T}$, где T -- количество наблюдений. Иногда в учебных целях иногда будем затрагивать последовательности с бесконечным числом элементов: $(y_t)_{t=1}^{t=+\infty}$ или $(y_t)_{t=-\infty}^{t=+\infty}$

В классических моделях машинного обучения мы предполагали наблюдения в обучающей выборке независимыми и одинаково распределёнными: $X = \{(x_1, y_1), \dots, (x_\ell, y_\ell)\}$. Однако от этих предпосылок нам придётся отказаться. Почти всегда элементы последовательности будут зависимы между собой и нашей задачей будет выяснить характер этой связи. Грубо говоря, нам необходимо восстановить характеристики случайного процесса по сгенерированной тракетории. Да, наличие структуры в данных не позволяет нам напрямую использовать стандартные техники машинного обучения, но в то же время из этой структуры можно выделить много дополнительной и полезной для прогнозирования информации.


Можем ли мы в принципе быть уверены, что сможем его восстановить? В какой-то мере ответ на это даёт Теорема Дуба о разложении \cite{doob}. Говоря в очень упрощённых терминах, она говорит о том, что почти любой "хороший"\ процесс можно разложить на прогнозируемую (детерминированную) и принципиально непрогнозируемую части. Следственно, мы никогда не сможем восстановить процесс идеально. Но тем не менее, часть процессов более склонна к детерминированному поведению, а часть -- менее. Например дневная температура яввляется очень сезонной величиной, то есть имеет паттерн, удобный для прогнозирования. Мы будем учиться обнаруживать и выделять такие паттерны в данных. С другой стороны, котировки акций наиболее близки к хаотичному движению и весьма трудно поддаются прогнозированию. Этим занимаются скорее в области количественных финансов. В нашем курсе котировки акций могут быть рассмотрены скорее из-за удобства и качества данных, но не более чем для иллюстрации. Исключение составит тема прогнозирования волатильности.




\section{Возможные постановки задач}

Задачи на временных рядах можно рассматривать с двух сторон. Во-первых, их можно свести к стандартным методам машинного обучения с минимальными оговорками в подготовке данных. Во-вторых, можно рассматривать это направление как развивавшееся независимо в контексте эконометрических задач с уклоном в логику описания данных. Мы кратко поговорим про первый подход и более подробно про второй.

\subsection{Случай одного ряда}

Предположим, что весь наш набор данных состоит из одного временного ряда $(y_t)_{t=1}^{T}$.  На основе него можно сформулировать следующие задачи. 

\subsubsection{Прогнозирование}

Эта задача наиболее популярна. Нам необходимо на основе истории наблюдений и, возможно, каких-то дополнительных данных о внешнем мире предсказать будущие значения ряда. Точку $T$ в таком случае называют \emph{forecast origin}. Пусть мы хотим построить прогноз на $h$ шагов вперёд относительно $T$. Тогда h называется горизонтом прогнозирования, \emph{forecast horizon}. Ещё можно встретить в некоторых библиотеках (например, sktime) понятие абсолютного и относительного горизонта. $T+h$ мы будем называть абсолютным горизонтом, а $h$ относительным.

Прогнозы могут быть различными по форме, но по сути своей они обычно пытаются приблизить некоторую статистику от распределения $y_{t+h}$. Основных можно выделить три:

\begin{enumerate}
	\item Точечный прогноз
	
	Самый простой случай. Мы просто хотим узнать конкретное значение показателя в зависимости от периода. Самые популярные модели обычно приближают математическое ожидание или квантиль распределения. Например, ARIMA, пытается приближать условное математическое ожидание $\mathbb{E}(y_{T+h} | (y_t)_{t=1}^{T})$	
	
	% TODO: Сценарное прогнозирование? Здесь или где-то дальше?		
	
	\item Прогноз изменчивости
	
	Обычно под этим подразумевается прогноз дисперсии и некоторые производные от этого. Мы будем более подробно говорить про это в разделе про прогнозирование риска.
	
	\item Интервальный прогноз
	
	Это некоторая комбинация двух предыдущих случаев. Требуется предсказать интервал, в который попадёт $y_{t+h}$ с некоторой заданной вероятностью. Например, 95\%. Для явного вычисления требуется знать закон распределения $y_{t+h}  | (y_t)_{t=1}^{T}$ или по крайней мере иметь способ расчёта квантилей. Мы разберём такие примеры в разделе про ETS-модели. 
	
	Существуют также способы приближённого вычисления доверительных интервалов с помощью симуляций. Мы обсудим это в разделе про прогнозирование риска.
	
\end{enumerate}

\subsubsection{Заполнение пропусков}

В стандратных кросс-секционных данных наблюдения с пропусками иногда не критичны. Например, если их мало, то несколько наблюдений можно удалить, или если пропуски сами по себе являются признаком, то можно их учесть. Стандартные модели временных рядов основываются на том, что в данных нет пропусков и наблюдения расположены через равные промежутки времени. Следовательно, заполнение пропусков может быть вспомогательной задачей прогнозирования. Оно может быть и независимой задачей, если нам необходимо восстановить какие-либо зависимости в прошлом.

\subsubsection{Декомпозиция}

\subsubsection{Детекция разладки}

\subsubsection{Агрегация и дезагрегация}

\subsection{Случай набора рядов}

\subsubsection{Задачи случая одного ряда}

\subsubsection{Классификация}

\subsubsection{Кластеризация}

\subsubsection{Выявление связи между рядами}

\section{Алгоритмы сглаживания}

\subsection{Moving average}

\subsection{OLS}

\subsection{LOESS}

\section{STL}

\begin{thebibliography}{1}
	\bibitem{doob}
	https://wikichi.ru/wiki/Doob\_decomposition\_theorem
\end{thebibliography}

\end{document}